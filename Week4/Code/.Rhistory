plot(focal.data$evolrate_difference ~ focal.data$omega_difference, pch=16, ylab="Difference in beak shape rate", xlab="Difference in dN/dS")
legend("topright", bty = "n", legend = paste0("Rho = ", round(mod$estimate,2), ";", " P = ", round(mod$p.value,2)), cex=0.7)
dev.off()
res <- rbind(res, c(fgene, fpc, mod$estimate, mod$p.value))
}
res <- data.frame(res, stringsAsFactors = F)
colnames(res) <- c("gene", "pc", "rho", "pval")
res$rho <- as.numeric(res$rho)
res$pval <- as.numeric(res$pval)
res[res$pval < 0.05,]
write.csv(only_significant, file = '/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant.csv')
only_significant <- res[res$pval < 0.05,]
write.csv(only_significant, file = '/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant.csv')
dat <-  read.csv('/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant_ADAPTED.csv')
library(knitr)
kable(dat, caption = 'Spearmans Rank correlation of differnces between morphological rates of evolution and genetic rates of evolution ')
dat <-  read.csv('/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant_ADAPTED.csv')
library(knitr)
kable(dat, caption = 'Spearmans Rank correlation of differnces between morphological rates of evolution and genetic rates of evolution ')
View(dd)
dat <- read.csv('/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/results/only_significant_ADAPTED.csv')
library(knitr)
kable(dat, caption = 'Spearmans Rank correlation of differnces between morphological rates of evolution and genetic rates of evolution ')
dat <-  read.csv('/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant_ADAPTED.csv')
library(knitr)
kable(dat, caption = 'Spearmans Rank correlation of differnces between morphological rates of evolution and genetic rates of evolution ')
dat <-  read.csv('/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant_ADAPTED.csv')
dat <- data.frame(dat)
library(knitr)
kable(dat, caption = 'Spearmans Rank correlation of differnces between morphological rates of evolution and genetic rates of evolution ')
View(dat)
dat <-  read.csv('/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant_ADAPTED.csv')
dat <- data.frame(dat)
library(knitr)
kable(dat, caption = 'Spearmans Rank correlation of differnces between morphological rates of evolution and genetic rates of evolution ')
rm(list=ls())
library(stringr)
dd <- read.csv("/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/evolratediff_omegadiff.csv", stringsAsFactors = F)
combos <- unique(dd[,c("gene","pc")])
res <- c()
for (i in 1:nrow(combos)) {
fgene <- combos$gene[i]
fpc <- combos$pc[i]
focal.data <- dd[dd$gene == fgene & dd$pc == fpc,]
focal.data <- focal.data[focal.data$omega_difference < 10,]
mod <- suppressWarnings(cor.test(focal.data$omega_difference, focal.data$evolrate_difference, method="spearman"))
pdf(paste0("/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/plots/", fgene, "_", fpc, ".pdf"), height=4, width=4)
par(mar=c(4.5,4.5,2,2))
plot(focal.data$evolrate_difference ~ focal.data$omega_difference, pch=16, ylab="Difference in beak shape rate", xlab="Difference in dN/dS")
legend("topright", bty = "n", legend = paste0("Rho = ", round(mod$estimate,2), ";", " P = ", round(mod$p.value,2)), cex=0.7)
dev.off()
res <- rbind(res, c(fgene, fpc, mod$estimate, mod$p.value))
}
res <- data.frame(res, stringsAsFactors = F)
colnames(res) <- c("gene", "pc", "rho", "pval")
res$rho <- as.numeric(res$rho)
res$pval <- as.numeric(res$pval)
res[res$pval < 0.05,]
res[res$pval < 0.1,]
res$pval.bon <- p.adjust(res$pval, method = "bonferroni")
res$pval.holm <- p.adjust(res$pval, method = "holm")
res$pval.hoch <- p.adjust(res$pval, method = "hochberg")
only_significant <- res[res$pval.bon < 0.05,]
write.csv(only_significant, file = '/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant.csv')
res[res$pval.bon < 0.1,]
res[res$pval.holm < 0.05,]
res[res$pval.holm < 0.1,]
res[res$pval.hoch < 0.05,]
res[res$pval.hoch < 0.1,]
p.adjust(res$pval[res$gene=="ALX1"], method="bonferroni")
head(res)
head(dd)
str(res)
write.csv(res, file = '/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/spearmans_rank_results.csv')
rm(list=ls())
library(stringr)
dd <- read.csv("/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/evolratediff_omegadiff.csv", stringsAsFactors = F)
combos <- unique(dd[,c("gene","pc")])
res <- c()
for (i in 1:nrow(combos)) {
fgene <- combos$gene[i]
fpc <- combos$pc[i]
focal.data <- dd[dd$gene == fgene & dd$pc == fpc,]
focal.data <- focal.data[focal.data$omega_difference < 10,]
mod <- suppressWarnings(cor.test(focal.data$omega_difference, focal.data$evolrate_difference, method="spearman"))
pdf(paste0("/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/plots/", fgene, "_", fpc, ".pdf"), height=4, width=4)
par(mar=c(4.5,4.5,2,2))
plot(focal.data$evolrate_difference ~ focal.data$omega_difference, pch=16, ylab="Difference in beak shape rate", xlab="Difference in dN/dS")
legend("topright", bty = "n", legend = paste0("Rho = ", round(mod$estimate,2), ";", " P = ", round(mod$p.value,2)), cex=0.7)
dev.off()
res <- rbind(res, c(fgene, fpc, mod$estimate, mod$p.value))
}
res <- data.frame(res, stringsAsFactors = F)
colnames(res) <- c("gene", "pc", "rho", "pval")
res$rho <- as.numeric(res$rho)
res$pval <- as.numeric(res$pval)
only_significant <- res[res$pval < 0.05,]
write.csv(only_significant, file = '/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant.csv')
res[res$pval < 0.1,]
res$pval.bon <- p.adjust(res$pval, method = "bonferroni")
res$pval.holm <- p.adjust(res$pval, method = "holm")
res$pval.hoch <- p.adjust(res$pval, method = "hochberg")
res[res$pval.bon < 0.05,]
res[res$pval.bon < 0.1,]
res[res$pval.holm < 0.05,]
res[res$pval.holm < 0.1,]
res[res$pval.hoch < 0.05,]
res[res$pval.hoch < 0.1,]
p.adjust(res$pval[res$gene=="ALX1"], method="bonferroni")
head(res)
head(dd)
str(res)
write.csv(res, file = '/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/spearmans_rank_results.csv')
print(res)
print(res)
res[res$pval.hoch < 0.1,]
dat <-  read.csv('/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/only_significant_ADAPTED.csv')
dat <- data.frame(dat)
library(knitr)
kable(dat, caption = 'Spearmans Rank correlation of differnces between morphological rates of evolution and genetic rates of evolution ')
<img src="/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/plots/ALX1_ PC2.pdf" alt="some text"  width="4200" height="4200">
img(src="/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/plots/ALX1_ PC2.pdf", alt="some text",  width="4200", height="4200")
<img(src="/home/bop16jpp/Dropbox/Toni-Joe/paiwise_PAML/analysis_files_scaled/scaled_results/plots/ALX1_ PC2.pdf", alt="some text",  width="4200", height="4200")>
knitr::opts_chunk$set(echo = TRUE)
dat <- read.csv('/home/bop16jpp/Documents/MRES_writeup/in progress/data/Full_table_of_genes.csv')
dat$X <-NULL
library(xtable)
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
options(xtable.comment = F)
Table_str <- xtable(dat, include.row.names = F, caption = "Genetic data statistics for each candidate gene for chicken as the reference.")
print (Table_str, include.rownames = F, latex.environments = "center", floating = TRUE, caption.placement = "top")
dat <- read.csv('/home/bop16jpp/Documents/MRES_writeup/in progress/data/Full_table_of_genes.csv')
dat$X <-NULL
library(xtable)
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
options(xtable.comment = F)
Table_str <- xtable(dat, include.row.names = F, caption = "Genetic data statistics for each candidate gene for chicken as the reference.")
print (Table_str, include.rownames = F, latex.environments = "center", floating = TRUE, caption.placement = "top")
landscape()
dat <- read.csv('/home/bop16jpp/Documents/MRES_writeup/in progress/data/Full_table_of_genes.csv')
dat$X <-NULL
library(xtable)
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
options(xtable.comment = F)
\begin(landscape)
dat <- read.csv('/home/bop16jpp/Documents/MRES_writeup/in progress/data/Full_table_of_genes.csv')
dat$X <-NULL
library(xtable)
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
options(xtable.comment = F)
Table_str <- xtable(dat, include.row.names = F, caption = "Genetic data statistics for each candidate gene for chicken as the reference.")
print (Table_str, include.rownames = F, latex.environments = "center", floating = TRUE, caption.placement = "top", floating.environment = 'landscape')
dat <- read.csv('/home/bop16jpp/Documents/MRES_writeup/in progress/data/Full_table_of_genes.csv')
dat$X <-NULL
library(xtable)
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
options(xtable.comment = F)
Table_str <- xtable(dat, include.row.names = F, caption = "Genetic data statistics for each candidate gene for chicken as the reference.")
print (Table_str, type = 'latex', include.rownames = F, latex.environments = "center", floating = TRUE, caption.placement = "top", floating.environment = 'sidewaystable')
dat <- read.csv('/home/bop16jpp/Documents/MRES_writeup/in progress/data/Full_table_of_genes.csv')
dat$X <-NULL
library(xtable)
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
options(xtable.comment = F)
Table_str <- xtable(dat, include.row.names = F, caption = "Genetic data statistics for each candidate gene for chicken as the reference.")
print (Table_str, type = 'latex', include.rownames = F, latex.environments = "center", floating = TRUE, caption.placement = "top", floating.environment = 'landscape')
dat <- read.csv('/home/bop16jpp/Documents/MRES_writeup/in progress/data/Full_table_of_genes.csv')
dat$X <-NULL
library(xtable)
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
options(xtable.comment = F)
Table_str <- xtable(dat, include.row.names = F, caption = "Genetic data statistics for each candidate gene for chicken as the reference.")
print (Table_str, type = 'latex', include.rownames = F, latex.environments = "center", floating = TRUE, caption.placement = "top")
library("ggplot")
2 + 3
ls
lib.paths
.libpath()
.libpaths()
6-9
-3/10
99-86
13/9
76/77
-123+1353
1230/123
-2/6
-3/8
2*-2 = (3*-2)-2
d <- read.table(datapath, header=T)
# load data
datapath = "../LectureMaterial/HandOutsandData_18/SparrowSize.txt"
d <- read.table(datapath, header=T)
setwd("~/CMEE/CMEECourseWork/Week4/Code")
# clear environment
rm(list=ls())
# load data
datapath = "../LectureMaterial/HandOutsandData_18/SparrowSize.txt"
d <- read.table(datapath, header=T)
# have a look
plot(d$Mass~d$Tarsus, ylab="Mass (g)",xlab="Tarsus (mm)", pch=19, cex=0.4)
d$Mass[1]
# line equation: yi = b0i + b1Xi + ei
d$Mass[1]
length(d$Mass)
plot(d$Mass~d$Tarsus,  ylab="Mass  (g)",  xlab="Tarsus  (mm)",  pch=19,  cex=0.4,
ylim=c(-5,38),  xlim=c(0,22))
plot(d$Mass~d$Tarsus,  ylab="Mass  (g)",  xlab="Tarsus  (mm)",  pch=19,  cex=0.4)
d1<-â€subset(d,  d$Mass!="NA")
d1 <- subset(d,  d$Mass!="NA")
d2 <- subset(d1,  d1$Tarsus!="NA")
d1 <- subset(d, d$Mass!="NA")
d2 <- subset(d1, d1$Tarsus!="NA")
length(d2$Tarsus)
# remove missing values for analysis by lm
d1 <- subset(d, d$Mass!="NA")
d2 <- subset(d1, d1$Tarsus!="NA")
length(d2$Tarsus)
# calculate lm
model1 <- â€lm(Mass~Tarsus, data=d2)
# calculate lm
model1 <-lm(Mass~Tarsus, data=d2)
summary(model1)
# have a look at the distribution of residuals
hist(model1$residuals)
head(model1$residuals)
model2<-lm(y~x)
# standardize
d2$z.Tarsus<-scale(d2$Tarsus)
model3<-lm(Mass~z.Tarsus, data=d2)
summary(model3)
plot(d2$Mass~d2$z.Tarsus, pch=19, cex=0.4)
abline(v = 0, lty = "dotted")
head(d)
d$Sex<-as.numeric(d$Sex)
par(mfrow = c(1, 2))
plot(d$Wing ~ d$Sex.1, ylab="Wing(mm)")
plot(d$Wing ~ d$Sex, xlab="Sex", xlim=c(-­â€0.1,1.1), ylab="")
abline(lm(d$Wing ~ d$Sex), lwd = 2)
text(0.15, 76, "intercept")
text(0.9, 77.5, "slope", col = "red")
d4<-subset(d, d$Wing!="NA")
m4<-lm(Wing~Sex, data=d4)
t4<-t.test(d4$Wing~d4$Sex, var.equal=TRUE)
summary(m4)
# have a look
plot(d$Mass~d$Tarsus, ylab="Mass (g)",xlab="Tarsus (mm)", pch=19, cex=0.4)
# load data
datapath = "../LectureMaterial/HandOutsandData_18/SparrowSize.txt"
d <- read.table(datapath, header=T)
# have a look
plot(d$Mass~d$Tarsus, ylab="Mass (g)",xlab="Tarsus (mm)", pch=19, cex=0.4)
# have a look
plot(d$Mass~d$Tarsus, ylab="Mass (g)",xlab="Tarsus (mm)", pch=19, cex=0.4, colour=d$Sex)
# have a look
plot(d$Mass~d$Tarsus, ylab="Mass (g)",xlab="Tarsus (mm)", pch=19, cex=0.4, col=d$Sex)
# have a look
plot(d$Mass~d$Tarsus, ylab="Mass (g)",xlab="Tarsus (mm)", pch=19, cex=0.4, col=d$Sex1)
# have a look
plot(d$Mass~d$Tarsus, ylab="Mass (g)",xlab="Tarsus (mm)", pch=19, cex=0.4)
lm(formula = d$Bill~d$Tarsus + d$Sex)
mod1 = lm(formula = d$Bill~d$Tarsus + d$Sex)
summary(mod1)
plot(mod1)
mod1 = lm(formula = d$Bill~d$Tarsus + d$Sex)
summary(mod1)
d1 <- subset(d, d$Bill !="NA")
d2 <- subset(d, d$Tarsus !="NA")
mod1 = lm(formula = d1$Bill~d2$Tarsus + d$Sex)
mod1 = lm(formula = d$Bill~d$Tarsus + d$Sex)
summary(mod1)
plot(d$Bill~d$Tarsus)
mod1 = lm(formula = d$Bill~d$Tarsus * d$Sex)
summary(mod1)
install.packages("minpack.lm")
# Load required packages #
require(minpack.lm)
require(ggplot2)
require(repr)
install.packages("repr")
require(repr)
powMod <- function(x, a, b) {
return(a * x^b)
}
MyData <- read.csv("../data/GenomeSize.csv")
# clear environment
rm(list=ls())
# Load required packages #
require(minpack.lm)
require(ggplot2)
require(repr)
powMod <- function(x, a, b) {
return(a * x^b)
}
MyData <- read.csv("../Data/GenomeSize.csv")
head(MyData)
# subset the data and remove NAs
Data2Fit <- subset(MyData,Suborder == "Anisoptera")
Data2Fit <- Data2Fit[!is.na(Data2Fit$TotalLength),]
# plot it
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
# plot it
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
setwd("~/CMEE/CMEECourseWork/MiniProject/Code")
#!/usr/bin/env Rscript
# Author: Joseph Palmer <Joseph.Palmer18@imperial.ac.uk>
# Date: October 2018
# Desc: NLLS practicle - Allometry
# clear environment
rm(list=ls())
# Load required packages #
require(minpack.lm)
require(ggplot2)
require(repr)
# create a function to create a power law model.
powMod <- function(x, a, b) {
return(a * x^b)
}
# read in the data and have a look
MyData <- read.csv("../Data/GenomeSize.csv")
head(MyData)
# subset the data and remove NAs
Data2Fit <- subset(MyData,Suborder == "Anisoptera")
Data2Fit <- Data2Fit[!is.na(Data2Fit$TotalLength),]
# plot it
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
# fit the model to the data using NLLS
PowFit <- nlsLM(BodyWeight ~ powMod(TotalLength, a, b), data = Data2Fit, start = list(a = .1, b = .1))
summary(PowFit)
anova(PowFit)
# generate a vector of body lengths for plotting
Lengths <- seq(min(Data2Fit$TotalLength),max(Data2Fit$TotalLength),len=200)
# calculate the predicted line -
coef(PowFit)["a"]
coef(PowFit)["b"]
# make plot predictions
Predic2PlotPow <- powMod(Lengths,coef(PowFit)["a"],coef(PowFit)["b"])
# plot the data dn the predicted model lines
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
lines(Lengths, Predic2PlotPow, col = 'blue', lwd = 2.5)
# We can claculate the confidence intervals on the estimated parameters as we would in OLS fitting used for Linear Models:
confint(PowFit)
setwd("~/CMEE/CMEECourseWork/Week3/Code")
#!/usr/bin/env Rscript
# Author: Joseph Palmer <Joseph.Palmer18@imperial.ac.uk>
# Date: October 2018
# Desc: ggplot practicle for data visualisation
# clear environment
rm(list=ls())
# Load required packages #
require(ggplot2)
# set data path
datapath = "../Data/EcolArchives-E089-51-D1.csv"
# load the data
MyDF <- read.csv(datapath)
head(MyDF)
# make the plot
p <- qplot(Prey.mass,
Predator.mass,
facets = Type.of.feeding.interaction ~.,
data = MyDF,
log = "xy",
xlab = "Prey Mass in grams",
ylab = "Predator mass in grams",
colour = Predator.lifestage)
q = p + stat_smooth(method = "lm", fullrange = TRUE) + geom_point(shape = 9) + theme_bw() + theme(legend.position="bottom")
# show the plot
q
summary(q)
# work out stats
for (i in unique(MyDF$Predator.lifestage)) {
print(i)
}
model <- lm(Prey.mass~Predator.mass, MyDF)
summary(model)
setwd("~/CMEE/CMEECourseWork/MiniProject/Code")
# clear environment
rm(list=ls())
# Load required packages #
require(minpack.lm)
require(ggplot2)
require(repr)
# create a function to create a power law model.
powMod <- function(x, a, b) {
return(a * x^b)
}
# read in the data and have a look
MyData <- read.csv("../Data/GenomeSize.csv")
head(MyData)
# subset the data and remove NAs
Data2Fit <- subset(MyData,Suborder == "Anisoptera")
Data2Fit <- Data2Fit[!is.na(Data2Fit$TotalLength),]
# plot it
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
# plot it
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
# fit the model to the data using NLLS
PowFit <- nlsLM(BodyWeight ~ powMod(TotalLength, a, b), data = Data2Fit, start = list(a = .1, b = .1))
summary(PowFit)
# generate a vector of body lengths for plotting
Lengths <- seq(min(Data2Fit$TotalLength),max(Data2Fit$TotalLength),len=200)
# calculate the predicted line - need to extract the coefficient from the model fit object using the coef()command.
coef(PowFit)["a"]
coef(PowFit)["b"]
# make plot predictions
Predic2PlotPow <- powMod(Lengths,coef(PowFit)["a"],coef(PowFit)["b"])
# plot the data dn the predicted model lines
qplot(Data2Fit$TotalLength, Data2Fit$BodyWeight))
# plot the data dn the predicted model lines
qplot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + geom_line(Lengths, Predic2PlotPow, col = 'blue', lwd = 2.5)
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + geom_smooth(Lengths, Predic2PlotPow, col = 'blue', lwd = 2.5)
?stat_smooth
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + stat_smooth(Lengths, Predic2PlotPow, col = "blue", lwd = 2.5)
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + stat_smooth(Lengths, Predic2PlotPow)
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + geom_line(color='red',data = Predic2PlotPow)
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + geom_line(color='red',data = Lengths)
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
lines(Lengths, Predic2PlotPow, col = 'blue', lwd = 2.5)
?geom_line
Lengths
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + geom_line(color='red',data = Lengths, stat = Predic2PlotPow)
?lines
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + geom_line()
?lines
?geom_line
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
stat_function(fun = function(x)
# plot the data dn the predicted model lines
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point() + stat_function(fun = function(x))
# plot the data dn the predicted model lines
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
lines(Lengths, Predic2PlotPow, col = 'blue', lwd = 2.5)
# plot the data dn the predicted model lines
plot(Data2Fit$TotalLength, Data2Fit$BodyWeight)
#ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
lines(Lengths, Predic2PlotPow, col = 'blue', lwd = 2.5)
ggplot(Data2Fit, aes(x = TotalLength, y = BodyWeight)) + geom_point()
setwd("~/CMEE/CMEECourseWork/Week4/Code")
# clear environment
rm(list=ls())
# load data
datapath = "../LectureMaterial/HandOutsandData_18/SparrowSize.txt"
d <- read.table(datapath, header=T)
# have a look
plot(d$Mass~d$Tarsus, ylab="Mass (g)",xlab="Tarsus (mm)", pch=19, cex=0.4)
# line equation: yi = b0i + b1Xi + ei
d$Mass[1]
length(d$Mass)
plot(d$Mass~d$Tarsus,  ylab="Mass  (g)",  xlab="Tarsus  (mm)",  pch=19,  cex=0.4,
ylim=c(-5,38),  xlim=c(0,22))
# remove missing values for analysis by lm
d1 <- subset(d, d$Mass!="NA")
d2 <- subset(d1, d1$Tarsus!="NA")
length(d2$Tarsus)
# calculate lm
model1 <-lm(Mass~Tarsus, data=d2)
summary(model1)
# have a look at the distribution of residuals
hist(model1$residuals)
head(model1$residuals)
# standardize
d2$z.Tarsus<-scale(d2$Tarsus)
model3<-lm(Mass~z.Tarsus, data=d2)
summary(model3)
# make plot with mark at 0
plot(d2$Mass~d2$z.Tarsus, pch=19, cex=0.4)
abline(v = 0, lty = "dotted")
head(d)
d$Sex<-as.numeric(d$Sex)
par(mfrow = c(1, 2))
plot(d$Wing ~ d$Sex.1, ylab="Wing(mm)")
plot(d$Wing ~ d$Sex, xlab="Sex", xlim=c(-­â€0.1,1.1), ylab="")
abline(lm(d$Wing ~ d$Sex), lwd = 2)
text(0.15, 76, "intercept")
text(0.9, 77.5, "slope", col = "red")
d4<-subset(d, d$Wing!="NA")
m4<-lm(Wing~Sex, data=d4)
t4<-t.test(d4$Wing~d4$Sex, var.equal=TRUE)
summary(m4)
head(d)
d$Sex<-as.numeric(d$Sex)
par(mfrow = c(1, 2))
plot(d$Wing ~ d$Sex.1, ylab="Wing(mm)")
plot(d$Wing ~ d$Sex, xlab="Sex", xlim=c(-0.1,1.1), ylab="")
abline(lm(d$Wing ~ d$Sex), lwd = 2)
text(0.15, 76, "intercept")
text(0.9, 77.5, "slope", col = "red")
d4<-subset(d, d$Wing!="NA")
m4<-lm(Wing~Sex, data=d4)
t4<-t.test(d4$Wing~d4$Sex, var.equal=TRUE)
summary(m4)
